<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wood Volume Calculator</title>

<link rel="manifest" href="manifest.json">

<style>
body{
  font-family: Arial;
  text-align:center;
  padding:20px;
}

h2{
  margin-bottom:20px;
}

input{
  padding:15px;
  margin:10px;
  width:85%;
  font-size:18px;
}

button{
  padding:15px 20px;
  margin:10px;
  font-size:18px;
  cursor:pointer;
}

#result{
  font-size:26px;
  margin-top:20px;
  font-weight:bold;
  color:green;
}
</style>
</head>

<body>

<h2>Wood Volume Calculator</h2>

<input id="a" placeholder="Length (mm)">
<input id="b" placeholder="Width (mm)">
<input id="c" placeholder="Height (mm)">

<br>

<button onclick="startVoice()">ðŸŽ¤ Speak 3 Numbers</button>
<button onclick="calc()">Calculate</button>

<div id="result">Result: --</div>

<script>

const aEl = document.getElementById('a');
const bEl = document.getElementById('b');
const cEl = document.getElementById('c');
const resultEl = document.getElementById('result');

function calc(){
  let A = +aEl.value || 0;
  let B = +bEl.value || 0;
  let C = +cEl.value || 0;

  let res = ((A/100)*(B/100)*(C/100))/16;

  resultEl.innerText = "Result: " + res.toFixed(3);
}

// ðŸŽ¤ Improved Voice Input
function startVoice(){

  let SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  let rec = new SpeechRecognition();

  rec.lang = "ml-IN";
  rec.continuous = true;      // keep listening
  rec.interimResults = false;

  rec.start();

  let silenceTimer;

  rec.onresult = (e)=>{

    clearTimeout(silenceTimer);

    let text = e.results[e.results.length-1][0].transcript;

    console.log("Heard:", text);

    let nums = text.match(/\d+/g);

    if(nums && nums.length >= 3){
      aEl.value = nums[0];
      bEl.value = nums[1];
      cEl.value = nums[2];
      calc();
      rec.stop();
    }

    // Stop after 12 seconds silence
    silenceTimer = setTimeout(()=>{
      rec.stop();
    }, 12000);
  };

  rec.onerror = ()=>{
    rec.stop();
  };
}

// Service Worker register
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('sw.js');
}

</script>

</body>
</html>
